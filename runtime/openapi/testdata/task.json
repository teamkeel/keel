{
  "openapi": "3.1.0",
  "info": {
    "title": "TasksAPI",
    "version": "1"
  },
  "paths": {
    "/topics/json": {
      "get": {
        "operationId": "listTopics",
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "topics": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Topic"
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "code": {
                      "type": "string"
                    },
                    "data": {
                      "type": ["object", "null"],
                      "properties": {
                        "errors": {
                          "type": "array",
                          "properties": {
                            "error": {
                              "type": "string"
                            },
                            "field": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/topics/json/{topic}": {
      "get": {
        "operationId": "getTopic",
        "responses": {
          "200": {
            "description": "Topic Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Topic"
                }
              }
            }
          },
          "400": {
            "description": "Topic Response Errors",
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "code": {
                      "type": "string"
                    },
                    "data": {
                      "type": ["object", "null"],
                      "properties": {
                        "errors": {
                          "type": "array",
                          "properties": {
                            "error": {
                              "type": "string"
                            },
                            "field": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters": [
        {
          "name": "topic",
          "in": "path",
          "required": true,
          "description": "",
          "schema": {
            "type": "string"
          }
        }
      ]
    },
    "/topics/json/{topic}/stats": {
      "get": {
        "operationId": "getTopicStats",
        "responses": {
          "200": {
            "description": "Topic Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Topic"
                }
              }
            }
          },
          "400": {
            "description": "Topic Response Errors",
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "code": {
                      "type": "string"
                    },
                    "data": {
                      "type": ["object", "null"],
                      "properties": {
                        "errors": {
                          "type": "array",
                          "properties": {
                            "error": {
                              "type": "string"
                            },
                            "field": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters": [
        {
          "name": "topic",
          "in": "path",
          "required": true,
          "description": "",
          "schema": {
            "type": "string"
          }
        }
      ]
    },
    "/topics/json/{topic}/tasks": {
      "post": {
        "operationId": "createTask",
        "requestBody": {
          "description": "",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "defer_until": {
                    "type": "string",
                    "format": "date-time"
                  }
                },
                "additionalProperties": false
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Task"
                }
              }
            }
          },
          "400": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "code": {
                      "type": "string"
                    },
                    "data": {
                      "type": ["object", "null"],
                      "properties": {
                        "errors": {
                          "type": "array",
                          "properties": {
                            "error": {
                              "type": "string"
                            },
                            "field": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "operationId": "getTasks",
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "tasks": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Task"
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "code": {
                      "type": "string"
                    },
                    "data": {
                      "type": ["object", "null"],
                      "properties": {
                        "errors": {
                          "type": "array",
                          "properties": {
                            "error": {
                              "type": "string"
                            },
                            "field": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters": [
        {
          "name": "limit",
          "in": "query",
          "required": false,
          "description": "",
          "schema": {
            "type": "number"
          }
        },
        {
          "name": "before",
          "in": "query",
          "required": false,
          "description": "",
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "after",
          "in": "query",
          "required": false,
          "description": "",
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "topic",
          "in": "path",
          "required": true,
          "description": "",
          "schema": {
            "type": "string"
          }
        }
      ]
    },
    "/topics/json/{topic}/tasks/{taskId}/assign": {
      "put": {
        "operationId": "assignTask",
        "requestBody": {
          "description": "",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "assigned_to": {
                    "type": "string"
                  }
                },
                "additionalProperties": false,
                "required": ["assigned_to"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Task Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Task"
                }
              }
            }
          },
          "400": {
            "description": "Task Response Errors",
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "code": {
                      "type": "string"
                    },
                    "data": {
                      "type": ["object", "null"],
                      "properties": {
                        "errors": {
                          "type": "array",
                          "properties": {
                            "error": {
                              "type": "string"
                            },
                            "field": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters": [
        {
          "name": "topic",
          "in": "path",
          "required": true,
          "description": "",
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "taskId",
          "in": "path",
          "required": true,
          "description": "",
          "schema": {
            "type": "string"
          }
        }
      ]
    },
    "/topics/json/{topic}/tasks/{taskId}/complete": {
      "put": {
        "operationId": "completeTask",
        "responses": {
          "200": {
            "description": "Task Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Task"
                }
              }
            }
          },
          "400": {
            "description": "Task Response Errors",
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "code": {
                      "type": "string"
                    },
                    "data": {
                      "type": ["object", "null"],
                      "properties": {
                        "errors": {
                          "type": "array",
                          "properties": {
                            "error": {
                              "type": "string"
                            },
                            "field": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters": [
        {
          "name": "topic",
          "in": "path",
          "required": true,
          "description": "",
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "taskId",
          "in": "path",
          "required": true,
          "description": "",
          "schema": {
            "type": "string"
          }
        }
      ]
    },
    "/topics/json/{topic}/tasks/{taskId}/defer": {
      "put": {
        "operationId": "deferTask",
        "requestBody": {
          "description": "",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "defer_until": {
                    "type": "string",
                    "format": "date-time"
                  }
                },
                "additionalProperties": false,
                "required": ["defer_until"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Task Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Task"
                }
              }
            }
          },
          "400": {
            "description": "Task Response Errors",
            "content": {
              "application/json": {
                "schema": {
                  "properties": {
                    "code": {
                      "type": "string"
                    },
                    "data": {
                      "type": ["object", "null"],
                      "properties": {
                        "errors": {
                          "type": "array",
                          "properties": {
                            "error": {
                              "type": "string"
                            },
                            "field": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "parameters": [
        {
          "name": "topic",
          "in": "path",
          "required": true,
          "description": "",
          "schema": {
            "type": "string"
          }
        },
        {
          "name": "taskId",
          "in": "path",
          "required": true,
          "description": "",
          "schema": {
            "type": "string"
          }
        }
      ]
    }
  },
  "components": {
    "schemas": {
      "Metrics": {
        "type": "object",
        "properties": {
          "completedToday": {
            "type": "number"
          },
          "oldestUnresolved": {
            "type": ["string", "null"],
            "format": "date-time"
          },
          "totalCount": {
            "type": "number"
          }
        },
        "required": ["totalCount", "completedToday"]
      },
      "Stats": {
        "type": "object",
        "properties": {
          "assignedCount": {
            "type": "number"
          },
          "completionRate": {
            "type": "number"
          },
          "completionTime90P": {
            "type": ["number", "null"]
          },
          "completionTime99P": {
            "type": ["number", "null"]
          },
          "completionTimeMedian": {
            "type": ["number", "null"]
          },
          "deferredCount": {
            "type": "number"
          },
          "openCount": {
            "type": "number"
          }
        },
        "required": [
          "openCount",
          "assignedCount",
          "deferredCount",
          "completionRate"
        ]
      },
      "Task": {
        "type": "object",
        "properties": {
          "assignedAt": {
            "type": "string",
            "format": "date-time"
          },
          "assignedTo": {
            "type": ["string", "null"]
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "deferredUntil": {
            "type": "string",
            "format": "date-time"
          },
          "flowRunId": {
            "type": ["string", "null"]
          },
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "resolvedAt": {
            "type": "string",
            "format": "date-time"
          },
          "status": {
            "type": "string",
            "enum": ["NEW", "ASSIGNED", "COMPLETED", "DEFERRED"]
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          }
        },
        "required": ["id", "name", "createdAt", "updatedAt"]
      },
      "Topic": {
        "type": "object",
        "properties": {
          "metrics": {
            "type": ["object", "null"],
            "$ref": "#/components/schemas/Metrics"
          },
          "name": {
            "type": "string"
          },
          "stats": {
            "type": ["object", "null"],
            "$ref": "#/components/schemas/Stats"
          }
        },
        "required": ["name"]
      }
    }
  }
}
