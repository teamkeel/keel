model Author {
  fields {
    name Text
  }
}

model Post {
  fields {
    content Text
    author Author
  }
  operations {
    // Validation for create operations checks that you have specified
    // all the mandatory fields as implicit or explicit inputs.

    // When it comes to HasOne relationship fields, e.g. Author, it recognizes
    // either "authorId", or "author" as satisfying that, either declared
    // as an implicit input, or referred to as the LHS of a set expression.
    
    // Declare "author" as implicit input.
    create createPostWithAuthor() with (content, author)

    // Declare "authorId" as implicit input.
    create createPostWithAuthorId() with (content, authorId)

    // Set "authorId" in a @set expression
    create createPostWithExpressionA() with (content) {
      @set(post.authorId = ctx.identity.id)
    }

    // todo: this passes the validation function under test, but is disabled because
    // it stimulates a different validation error: (incompatible types for LHS and RHS)
    // 
    // See this Linear ticket for the discussion:
    //  https://linear.app/keel/issue/RUN-187/create-operation-product-question-mandatory-inputs-for-relationship
    //
    // Set "author" in a @set expression
    //
    // create createPostWithExpressionB() with (content) {
    //   @set(post.author = ctx.identity.id)
    // }
  }
}
