model User {
    fields {
        assignedProduct Product 
        identity Identity @unique
    }
}


model Product {
    fields {
        sku Text @unique
        stock ProductStock @unique
    }
    actions {
        get getbyWarehouseBarcode(barcode: Text) {
            @where(product.stock.warehouseBarcode == barcode)
        }

        get getbySupplierSku(supplierSku: Text, supplierId: ID) {
            @where(product.stock.supplierSku == supplierSku and product.stock.supplier.id == supplierId)
        }

        get getbySupplierSkuAndCode(supplierSku: Text, supplierCode: Text) {
            @where(product.stock.supplierSku == supplierSku and product.stock.supplier.supplierCode == supplierCode)
        }
    }
}

model ProductStock {
    fields {
        warehouseBarcode Text @unique
        supplierSku Text 
        supplier Supplier
    }

    @unique([supplierSku, supplier])
}

model Supplier {
    fields {
        supplierCode Text @unique
    }
}