import { actions, resetDatabase, models } from "@teamkeel/testing";
import { useDatabase, Thing } from "@teamkeel/sdk";
import { test, expect, beforeEach } from "vitest";
import { sql } from "kysely";

beforeEach(resetDatabase);

test("vectors - create action", async () => {
  const result = await actions.createThing({ vector: vec });

  expect(result.vector).toEqual(vec);
});

test("vectors - get action", async () => {
  const createResult = await actions.createThing({ vector: vec });
  const getResult = await actions.getThing({ id: createResult.id });

  expect(getResult?.vector).toEqual(vec);
});

test("vectors - insert with raw sql", async () => {
  const createdResponse =
    await sql<Thing>`INSERT INTO thing (vector) VALUES ('[${sql.raw(vec.toString())}]') RETURNING *`.execute(
      useDatabase()
    );

  const getResult = await actions.getThing({ id: createdResponse.rows[0].id });

  expect(getResult?.vector).toEqual(vec);
});

const vec = [
  1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 8.62622, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002,
  1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002,
  1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002,
  1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002,
  1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002,
  1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002,
  1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002,
  1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002,
  1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002,
  1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002,
  1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002,
  1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002,
  1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002,
  1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002,
  1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002,
  1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002,
  1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002,
  1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 2, 0.4, 11.2, 6.3, 13.9, 4.2,
  0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2,
  0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2,
  0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2,
  0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 9.9, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9,
  4.2, 0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 11.2, 6.3, 13.9, 4.2,
  0.002, 1.1, 0.4, 11.2, 6.3, 13.9, 4.2, 0.002, 1.1, 0.4, 11.2,
];
